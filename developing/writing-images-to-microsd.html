<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>OpenIVI Mobility : Writing images to microSD</title>
        <meta name="description" content="Get your code moving">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
    </head>
    <body>

        <div class="container-fluid">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <h4><a class="brand" href="/">OpenIVI Mobility</a>
    <small>Get your code moving</small>
</h4>

                </div>
            </div>

            <div class="row">
                
                
                    <div id="navigation" class="col-sm-3">
                        <ul class="nav nav-list">
    <li><a href="/">Home</a></li>
    
        
        

        
            
                <li class="nav-header">Developing</li>
            
            <li data-order=""><a href="/developing/setting-up-an-html5-development-environment.html">Setting up an HTML5 development environment</a></li>
        
            
            <li data-order=""><a href="/developing/how-to-cut-a-release-of-openivi.html">How to cut a release of OpenIVI</a></li>
        
            
            <li data-order=""><a href="/developing/building-openivi-in-yocto.html">Building with Yocto</a></li>
        
            
            <li data-order=""><a href="/developing/writing-images-to-microsd.html">Writing images to microSD</a></li>
        
    
        
        

        
    
        
        

        
            
                <li class="nav-header">Hardware</li>
            
            <li data-order=""><a href="/hardware/build-your-own-head-unit.html">Build your own head unit</a></li>
        
    
        
        

        
    
        
        

        
    
        
        

        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                    </div>

                    <div id="content" class="col-sm-9">
                        <div id="content" class="col-sm-10">
                            <div class="page-header">
    <h2>Writing images to microSD
        
    </h2>
</div>

<div class="paragraph">
<p>There are several ways to write the rootfs and kernel image created by Yocto to a bootable disk. The type of image and how it is written to disk affects the boot process in subtle ways, therefore it is recommended to use a single method: mkefidisk.sh in meta-oim/scripts.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t have a linux machine available to write the disk, then UNetbootin (for Windows or MacOS) can be used; see the description at the end of this document. Note that mkefidisk.sh is unlikely to work inside a VM.</p>
</div>
<div class="sect1">
<h2 id="mkefidisk-recommended">mkefidisk (Recommended)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following incantation is suitable for writing to a microSD card on Linux:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo ../meta-oim/scripts/mkefidisk.sh /dev/sdX tmp/deploy/images/genericx86-64/openivi-image-genericx86-64.iso /dev/mmcblk0</pre>
</div>
</div>
<div class="paragraph">
<p>If the SOTA_TOML environment variable is set, then mkefidisk will copy that file into /etc/sota.toml, provisioning the machine at image creation time. Since sudo squashes environment variables by default, the value of SOTA_TOML needs to be passed in explicitly:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo SOTA_TOML=/tmp/mysota.toml ../meta-oim/scripts/mkefidisk.sh /dev/sdX tmp/deploy/images/genericx86-64/openivi-image-genericx86-64.iso /dev/mmcblk0</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="provisioning-options">Provisioning options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are 3 ways to provision sota_client:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ethernet MAC address based - traditional</p>
</li>
<li>
<p>sota.toml stored in efivars - First get the sota.toml onto the device, then run  <code>ota-plus-demo-provision sota.toml</code> to save it in EFI. ota-plus-demo-provision will read from there even after the SD card has been reflashed.</p>
</li>
<li>
<p>mkefidisk.sh - As above, passed via the <code>SOTA_TOML</code> environment variable.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="unetbootin-backup">UNetbootin (Backup)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As a backup, UNetbootin can be used to write the image.</p>
</div>
<div class="paragraph">
<p>Here are the installation steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and install <a href="https://unetbootin.github.io/">UNetbootin</a></p>
</li>
<li>
<p>Download the OpenIVI image.</p>
</li>
<li>
<p>Unzip the image. (You should be able to simply double-click it to unzip.)</p>
</li>
<li>
<p>Remove the microSD card from the OpenIVI unit.  Unscrew the cover of the unit with the screws on the back. The microSD card slot is in the top left of the MinnowBoard Turbot, next to the USB connectors. This is easier with small hands.</p>
</li>
<li>
<p>Plug the microSD card into a laptop (either Windows or Mac) using a SD card reader</p>
</li>
<li>
<p>Open UNetbootin, and select the "Diskimage - ISO" option.</p>
</li>
<li>
<p>Select the OpenIVI image you downloaded.</p>
</li>
<li>
<p>Select the microSD card you just inserted, and click OK. Copying the image may take a few minutes.</p>
</li>
<li>
<p>Close UNetbootin and eject the microSD card from your computer.</p>
</li>
<li>
<p>You can now insert this microSD card back into the OpenIVI head unit.</p>
</li>
<li>
<p>Connect OpenIVI to the network using wired ethernet, and power it on.</p>
</li>
<li>
<p>The device should boot into the OpenIVI graphical interface.  If this is an ATS image, it will appear in the sales demo account of <a href="https://app.atsgarage.com">ATS Garage</a></p>
</li>
</ol>
</div>
</div>
</div>

                        </div>
                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    Documentation for <a href="https://github.com/openivimobility">OpenIVI Mobility</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
    </body>
</html>
